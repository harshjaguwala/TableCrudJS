<!DOCTYPE html>
<html>

<head>

  <style>
    * {
      box-sizing: border-box;
    }

    small {
      color: red;
    }

    span {
      color: red;
    }

    h4 {
      background-color: #005cb9;
      color: #fff !important;
      padding: 5px;
      margin-top: 0;
    }

    h2 {
      text-align: center;
      text-decoration: underline;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"],
    select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      outline: none;
    }

    label {
      padding: 12px 12px 12px 0;
      display: inline-block;
      font-weight: bold;
    }

    input[type=submit] {
      background-color: #005cb9;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    input[type=button] {
      background-color: red;
      color: white;
      font-weight: bold;
      padding: 12px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    input[type=button]:hover {
      background-color: black;
    }

    input[type=submit]:hover {
      background-color: #45a049;
    }

    .container {
      overflow: auto;
      padding: 20px;
    }

    .col-25 {
      float: left;
      width: 25%;
      margin-top: 6px;
    }

    .col-75 {
      float: left;
      width: 75%;
      margin-top: 6px;
    }

    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }

    .table-container {
      margin: 20px auto;
      max-width: 800px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }


    #table-row {
      margin-top: 30px;
    }

    table,
    th,
    td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }

    /* Responsive layout - when the screen is less than 600px wide, make the two columns stack on top of each other instead of next to each other */
    @media screen and (max-width: 600px) {

      .col-25,
      .col-75,
      input[type=submit] {
        width: 100%;
        margin-top: 0;
      }
    }
  </style>

  <script>
    const hobbies = [];

    // --------------------- Basic table & submit button --------------------
    function employee() {
      const form = document.getElementById("employeeForm");

      form.addEventListener("keyup", validateForm);

      if (validateForm()) {
        if (document.getElementById("hobby1").checked) hobbies.push("Cricket");
        if (document.getElementById("hobby2").checked) hobbies.push("Chess");
        if (document.getElementById("hobby3").checked) hobbies.push("Music");

        const name = form.elements.name.value;
        const gender = form.elements.gender.value;
        const dob = form.elements.dob.value;
        const email = form.elements.email.value;
        const phone = form.elements.phone.value;
        const hobby = hobbies;

        // Create an object to store employee data
        const employeeData = {
          name: name,
          gender: gender,
          dob: dob,
          email: email,
          phone: phone,
          hobbies: hobby,
        };

        // Get existing data from local storage or create an empty array
        let employees = JSON.parse(localStorage.getItem("employees")) || [];

        // Add the new employee data to the array
        employees.push(employeeData);

        // Store the updated array in local storage
        localStorage.setItem("employees", JSON.stringify(employees));

        // Add the data to the basic table
        const table = document.getElementById("employeeTable");
        const newRow = table.insertRow();
        const cells = [name, gender, dob, email, phone, hobbies];
        for (let i = 0; i < cells.length; i++) {
          const cell = newRow.insertCell(i); // create a row
          cell.textContent = cells[i]; // insert data
        }

        updateAdvancedTable();

        // Clear the form fields
        form.reset();
        window.location.reload();
        hobbies.splice(0, hobbies.length);

      }
    }

    // ------- Advanced Table Data ---------------
    let column = 0;
    function updateAdvancedTable() {
      let nameRow = document.getElementById("nameField");
      let genderRow = document.getElementById("genderField");
      let DOBRow = document.getElementById("DOBField");
      let EmailRow = document.getElementById("EmailField");
      let PhoneRow = document.getElementById("PhoneField");
      let HobbyRow = document.getElementById("HobbyField");

      {
        column++;
        cell1 = nameRow.insertCell(column);
        cell1.innerHTML = document.getElementById("name").value;

        cell2 = genderRow.insertCell(column);
        cell2.innerHTML = document.querySelector('input[name="gender"]:checked').value;

        cell3 = DOBRow.insertCell(column);
        cell3.innerHTML = document.getElementById("dob").value;

        cell4 = EmailRow.insertCell(column);
        cell4.innerHTML = document.getElementById("email").value;

        cell5 = PhoneRow.insertCell(column);
        cell5.innerHTML = document.getElementById("phone").value;

        cell6 = HobbyRow.insertCell(column);
        cell6.innerHTML = hobbies;
      }
    }

    // ------------- Validation ----------------------
    function validateForm() {
      const form = document.getElementById("employeeForm");
      const name = form.elements.name.value;
      const dob = form.elements.dob.value;
      const email = form.elements.email.value;
      const phone = form.elements.phone.value;

      const nameInput = document.getElementById("name");
      const nameError = document.getElementById("name-error")
      const dobInput = document.getElementById("dob");
      const dobError = document.getElementById("dob-error")
      const emailInput = document.getElementById("email");
      const emailError = document.getElementById("email-error")
      const phoneInput = document.getElementById("phone");
      const phoneError = document.getElementById("phone-error")

      let isValid = true;

      if (name.trim() === "") {
        nameError.innerHTML = "Name is required";
        nameInput.style.borderColor = "red";
        isValid = false;
      } else if (name.length < 4 || name.length > 20) {
        nameError.innerHTML = "Name must be between 4 and 20 characters";
        nameInput.style.borderColor = "red";
        isValid = false;
      } else {
        nameError.innerHTML = "";
        nameInput.style.borderColor = "green";
      }

      const currentDate = new Date();
      const selectedDate = new Date(dob);
      if (!dob || selectedDate >= currentDate) {
        dobError.innerHTML = "Please enter a valid date of birth";
        dobInput.style.borderColor = "red";
        isValid = false;
      } else {
        dobError.innerHTML = "";
        dobInput.style.borderColor = "green";
      }

      if (!email.trim() || !validateEmail(email)) {
        emailError.innerHTML = "Please enter a valid email address";
        emailInput.style.borderColor = "red";
        isValid = false;
      } else {
        emailError.innerHTML = "";
        emailInput.style.borderColor = "green";
      }

      const phonePattern = /^[0-9]{10}$/;
      if (phone.trim() !== "" && !phone.match(phonePattern)) {
        phoneError.innerHTML = "Please enter a 10-digit phone number";
        phoneInput.style.borderColor = "red";
        isValid = false;
      } else {
        phoneError.innerHTML = "";
        phoneInput.style.borderColor = "green";
      }

      return isValid;
    }

    function validateEmail(email) {
      const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;
      return email.match(emailPattern);
    }


    // ------------ Refresh the Page & LocalStorage Get the All Data in basic table web page --------------------------
    window.addEventListener("load", function () {
      // Get the existing data from local storage
      let employees = JSON.parse(localStorage.getItem("employees")) || [];
      // Display data in the basic table
      const table = document.getElementById("employeeTable");
      employees.forEach(function (employeeData, index) {
        const newRow = table.insertRow();
        const cells = [
          employeeData.name,
          employeeData.gender,
          employeeData.dob,
          employeeData.email,
          employeeData.phone,
          employeeData.hobbies.join(", "),
          `<button onclick="editEmployee(${index})">Edit</button> 
      <button onclick="deleteEmployee(${index})">Delete</button>`
        ];

        for (let i = 0; i < cells.length; i++) {
          const cell = newRow.insertCell(i);
          cell.innerHTML = cells[i];
        }
      });

      // Display data in the advanced table
      employees.forEach(function (employeeData, index) {
        getAdvancedTable(employeeData, index);
      });
    });

    // ------------ Refresh the Page & LocalStorage Get the All Data in advanced table web page --------------------------
    function getAdvancedTable(employeeData, index) {
      let nameRow = document.getElementById("nameField");
      let genderRow = document.getElementById("genderField");
      let DOBRow = document.getElementById("DOBField");
      let EmailRow = document.getElementById("EmailField");
      let PhoneRow = document.getElementById("PhoneField");
      let HobbyRow = document.getElementById("HobbyField");
      let ActionRow = document.getElementById("ActionField");

      column++;
      cell1 = nameRow.insertCell(column);
      cell1.innerHTML = employeeData.name;

      cell2 = genderRow.insertCell(column);
      cell2.innerHTML = employeeData.gender;

      cell3 = DOBRow.insertCell(column);
      cell3.innerHTML = employeeData.dob;

      cell4 = EmailRow.insertCell(column);
      cell4.innerHTML = employeeData.email;

      cell5 = PhoneRow.insertCell(column);
      cell5.innerHTML = employeeData.phone;

      cell6 = HobbyRow.insertCell(column);
      cell6.innerHTML = employeeData.hobbies.join(", "); // Display hobbies as a comma-separated string

      cell7 = ActionRow.insertCell(column);
      cell7.innerHTML = `<button onclick="editEmployee(${index})">Edit</button>
  <button onclick="deleteEmployee(${index})">Delete</button>`;
    }

    // Add an event listener to handle the Edit button click
    function editEmployee(index) {
      const employees = JSON.parse(localStorage.getItem("employees")) || [];
      const employeeData = employees[index];

      // Populate the form fields with the selected employee's data
      const form = document.getElementById("employeeForm");
      form.elements.name.value = employeeData.name;
      form.elements.gender.value = employeeData.gender;
      form.elements.dob.value = employeeData.dob;
      form.elements.email.value = employeeData.email;
      form.elements.phone.value = employeeData.phone;

      // Populate hobbies checkboxes
      const hobbies = employeeData.hobbies;
      document.getElementById("hobby1").checked = hobbies.includes("Cricket");
      document.getElementById("hobby2").checked = hobbies.includes("Chess");
      document.getElementById("hobby3").checked = hobbies.includes("Music");

      // Update the form submit button to handle editing
      const submitButton = form.querySelector("input[type=submit]");
      submitButton.value = "Update";
      submitButton.onclick = function () {
        updateEmployee(index);
      };

      // Show the Cancel button
      const cancelButton = form.querySelector("#cancelButton");
      cancelButton.style.display = "inline-block";
      cancelButton.onclick = function () {
        cancelEdit();
      };
    }

    // Create a function to update employee data
    function updateEmployee(index) {
      const form = document.getElementById("employeeForm");
      const employees = JSON.parse(localStorage.getItem("employees")) || [];
      const employeeData = employees[index];

      form.addEventListener("keyup", validateForm);
      if (validateForm()) {
        // Update employee data with the form fields
        employeeData.name = form.elements.name.value;
        employeeData.gender = form.elements.gender.value;
        employeeData.dob = form.elements.dob.value;
        employeeData.email = form.elements.email.value;
        employeeData.phone = form.elements.phone.value;

        // Update hobbies based on checkbox selection
        employeeData.hobbies = [];
        if (document.getElementById("hobby1").checked) employeeData.hobbies.push("Cricket");
        if (document.getElementById("hobby2").checked) employeeData.hobbies.push("Chess");
        if (document.getElementById("hobby3").checked) employeeData.hobbies.push("Music");

        // Update data in both tables and local storage
        employee();
        updateAdvancedTable();
        localStorage.setItem("employees", JSON.stringify(employees));

        // Reset the form 
        form.reset();
      }
    }

    // ------------------ Delete -----------------------
    // Function to delete an employee from both tables and local storage
    function deleteEmployee(index) {
      const employees = JSON.parse(localStorage.getItem("employees")) || [];

      // Confirm the deletion
      const confirmDelete = confirm("Are you sure you want to delete this employee?");
      if (!confirmDelete) return;

      // Remove the employee from the array
      employees.splice(index, 1);

      window.location.reload();
      // Update data in both tables and local storage
      employee(employees);
      updateAdvancedTable(employees);
      localStorage.setItem("employees", JSON.stringify(employees));
    }


    // Create a function to cancel editing and reset the form
    function cancelEdit() {
      const form = document.getElementById("employeeForm");

      const submitButton = form.querySelector("input[type=submit]");
      submitButton.value = "Submit";
      submitButton.onclick = function () {
        employee();
        updateAdvancedTable();
        return false;
      };

      form.reset();
      const cancelButton = form.querySelector("#cancelButton");
      cancelButton.style.display = "none";
    }
  </script>

</head>

<body>

  <h2> Employee Information </h2>
  <div style="border: 1px solid #005cb9; border-radius: 5px;">
    <h4> Add Employee </h4>
    <div class="container">
      <form id="employeeForm">

        <!-- ----- Name ---- -->
        <div class="row">
          <div class="col-25">
            <label for="name">Name <small> * </small> :</label>
          </div>
          <div class="col-75">
            <input type="text" id="name" name="name" placeholder="Your name.." minlength="4" maxlength="20" required>
            <span class="error-message" id="name-error"></span>
          </div>
        </div>
        <br />

        <!-- ----- Gender ---- -->
        <div class="row">
          <div class="col-25">
            <label>Gender <small> * </small> :</label>
          </div>
          <div class="col-75">
            <input type="radio" id="male" name="gender" value="Male" checked> Male
            <input type="radio" id="female" name="gender" value="Female"> Female
            <span class="error-message" id="gender-error"></span>
          </div>
        </div>
        <br />

        <!-- ----- Date Of Birth ---- -->
        <div class="row">
          <div class="col-25">
            <label for="dob">Date of Birth <small> * </small> :</label>
          </div>
          <div class="col-75">
            <input type="date" id="dob" name="dob" placeholder="Your birth-date.."
              onfocus="this.max=new Date().toISOString().split('T')[0]" required>
            <span class="error-message" id="dob-error"></span>
          </div>
        </div>
        <br />

        <!-- ----- Email ID ---- -->
        <div class="row">
          <div class="col-25">
            <label for="email">Email <small> * </small> :</label>
          </div>
          <div class="col-75">
            <input type="email" id="email" name="email" placeholder="Your email.." required>
            <span class="error-message" id="email-error"></span>
          </div>
        </div>
        <br />

        <!-- ----- Phone Number ---- -->
        <div class="row">
          <div class="col-25">
            <label for="phone">Phone Number :</label>
          </div>
          <div class="col-75">
            <input type="tel" id="phone" name="phone" placeholder="Your Phone Number.." pattern="[0-9]{10}"
              maxlength="10">
            <span class="error-message" id="phone-error"></span>
          </div>
        </div>
        <br />

        <!-- ----- Hobbies ---- -->
        <div class="row">
          <div class="col-25">
            <label for="hobbies">Hobbies :</label>
          </div>
          <div class="col-75">
            <input type="checkbox" value="Cricket" id="hobby1" class="txtcricket" name="hobby"> Cricket <br />
            <input type="checkbox" value="Chess" id="hobby2" class="txtchess" name="hobby"> Chess <br />
            <input type="checkbox" value="Music" id="hobby3" class="txtmusic" name="hobby"> Music <br />
          </div>
        </div>
        <br />

        <!-- ----- Submit Button ---- -->
        <div class="row">
          <input type="submit" value="Submit" id="submitButton" onclick="employee();return false">
          <input type="button" value="Cancel" id="cancelButton" style="display: none;">
        </div>

      </form>
    </div>
  </div>
  <br />

  <!-- ----- Basic Table ---- -->
  <h2> Basic </h2>
  <div style="border: 1px solid #005cb9; border-radius: 5px;">
    <h4> Display </h4>
    <div class="container">
      <table id="employeeTable" border="1">
        <tr>
          <th>Name</th>
          <th>Gender</th>
          <th>Date of Birth</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Hobbies</th>
          <th>Action</th>
        </tr>
      </table>
    </div>
  </div>
  <br />

  <!-- ----- Advanced Table ---- -->
  <h2> Advanced </h2>
  <div style="border: 1px solid #005cb9; border-radius: 5px;">
    <h4> Display </h4>
    <div class="container">
      <table id="advancedTable" border="1">
        <tr id="nameField">
          <th>Name</th>
        </tr>
        <tr id="genderField">
          <th>Gender</th>
        </tr>
        <tr id="DOBField">
          <th>DOB</th>
        </tr>
        <tr id="EmailField">
          <th>Email</th>
        </tr>
        <tr id="PhoneField">
          <th>Phone</th>
        </tr>
        <tr id="HobbyField">
          <th>Hobbies</th>
        </tr>
        <tr id="ActionField">
          <th>Action</th>
        </tr>
      </table>
    </div>
  </div>

</body>

</html>